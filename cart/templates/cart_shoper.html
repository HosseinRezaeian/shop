{% extends 'base.html' %}
{% load static %}
{% load django_template_maths %}

{% block content %}
     <link href="{% static 'fontawesomefree/css/all.min.css' %}" rel="stylesheet" type="text/css">
        <script src="{% static 'fontawesomefree/js/all.min.js' %}"></script>
<style>
.div_org{
    height:100%;
    margin-bottom:20%;

}
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 90%;
    height=100%;
    margin-right: 5%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
    <div class="div_org" >


<table id="tb" dir="ltr">
  <tr>
    <th>محصول</th>
    <th>تعداد</th>
    <th>قیمت</th>
      <th>مجموع قیمت</th>
  </tr>
{% for dit in cart_shop.order_details_set.all %}
<tr >
    <th>{{ dit.product.title }}</th>
    <th> <input id="id_p" value="{{ dit.id }}" type="hidden"> <input  id="num{{ dis.id }}"  style="width:8%;border:solid 1px chocolate; " min="1" value="{{ dit.countp }}" type="number"><button onclick="savecount('num{{ dis.id }}')" >ذخیره</button> </th>
    <th>{{dit.product.price}}</th>
    <th>{{dit.countp|mul:dit.product.price}}</th>
    <th><a onclick="add({{ dit.id }})">حذف</a></th>
</tr>
{% endfor %}

</table>
</div>
    <script>
    function add(dit_id) {


 console.log(dit_id);
$.get("{% url 'remove_cart' %}",{
    ditail_id : dit_id

}).then(result => {
    console.log(result);

    $('#tb').html(result);
});


}



function savecount(id) {


    const num = $("#num").val();
    const id_p = $("#id_p").val();


    console.log(num);
    console.log(id_p);


    $.get("{% url 'save_count' %}",{
    num,id_p

}).then(result => {
    console.log(result);

    $('#tb').html(result);
});

}




</script>


{% endblock %}